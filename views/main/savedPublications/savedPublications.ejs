<% layout('./layouts/boilerplate') %>
<div class="container d-flex flex-column align-items-center">
  <%- include('../../partials/flash') %>
  <h1 class="my-4 headerColor">Publicaciones Guardadas</h1>
  <%for(let publications of savedPublication){%>
  <div class="card mb-3">
    <div class="card-body">
      <h5 class="card-title" style="color: black">
        <%= publications.publications.title%>
      </h5>
      <p class="card-text" style="color: black">
        <%= publications.publications.description%>
      </p>
      <p
        id="date"
        value="<%= publications.publications.date%>"
        class="card-text"
        style="color: black"
      ></p>

      <form
        action="/deleteSavedPublication/<%= publications._id%>?_method=DELETE"
        method="POST"
      >
        <a
          href="/publicacion/<%= publications.publications._id%>"
          class="btn btn-primary"
          >Ver Publicacion</a
        >
        <button type="submit" class="btn btn-danger">Quitar Publicacion</button>
      </form>
    </div>
  </div>
  <% } %>
</div>
<script>
  const publiDate = document.querySelectorAll("#date");
  for (let i = 0; i < publiDate.length; i++) {
    const dateString = publiDate[i].getAttribute("value");
    const date = new Date(dateString);

    const days = [
      "Domingo",
      "Lunes",
      "Martes",
      "Miercoles",
      "Jueves",
      "Viernes",
      "Sabado",
    ];

    const months = [
      "Enero",
      "Febrero",
      "Marzo",
      "Abril",
      "Mayo",
      "Junio",
      "Julio",
      "Agosto",
      "Septiembre",
      "Octubre",
      "Noviembre",
      "Diciembre",
    ];

    const day = days[date.getDay()];

    const month = months[date.getMonth()];

    const year = date.getFullYear();

    const dayOfMonth = date.getDate();

    const hours = date.getHours();

    const minutes = date.getMinutes();

    const normalHours = (hours) => {
      if (hours > 12) {
        return hours - 12;
      } else {
        return hours;
      }
    };

    const pmAm = (hours) => {
      if (hours > 12) {
        return "PM";
      } else {
        return "AM";
      }
    };

    publiDate[
      i
    ].innerHTML = `${day} ${dayOfMonth} de ${month},${year} a las ${normalHours(
      hours
    )}:${minutes} ${pmAm(hours)} `;
  }
</script>
